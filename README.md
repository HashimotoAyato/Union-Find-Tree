# Union-Find木
## Union-Find木とは
グループ分けを管理するデータ構造で次の操作を効率的に行うことができる。
併合はできても分割はできないことに注意。
* 要素aと要素bが同じグループに属するかを調べる
* 要素aと要素bのグループを併合する
## 計算量
各操作は$O(\alpha(n))$となる。$\alpha(n)$はアッカーマン関数の逆関数であり、$O(\log n)$よりも高速である。

## 仕組み
木構造(二分木ではない)によって実現される。
各要素は1つのノード、1つのグループは1つの木として表現する。
どのノードが親になっているかや木の形は重要ではなく、木になっていることが大切である。


### 初期化
n個の要素に対して、n個のノードを用意する。(はじめは辺なし)

### 併合
片方の木のルートから、もう片方の木のルートに辺を追加すると、1つの木となりグループが併合される。

### 判定
木を上向きに探索してルートを調べる。それぞれ同じルートにたどり着けば同じグループである。

## 実装の注意点
平衡二分木と同様、木に偏りが発生しないような工夫が必要となる。
Union-Find木の場合は簡単に次の方法で実現できる。

* 各木のランク(木の高さ)を記憶しておく
* 併合のとき、それぞれの木のランクが異なれば、ランクが小さいものから大きいものへ辺を張る。
* ルートを求める際に通ったノードについて、親を直接ルートに変更することで、辺を縮約することができる。この縮約を行っても簡単のためにランクは変更しない。

# Union-Find木を用いた問題
## 問題1：食物連鎖(POJ 1182)
N匹の動物が、$1,2,...,N$と番号が付けられている。動物は3つの種類A,B,Cのいずれかがいる。
AはBを食べ、BはCを食べ、CはAを食べる。次の2種類の情報が順番にK個与えられる。
* タイプ1：xとyが同じ種類
* タイプ2：xはyを食べる

これらの情報が全て正しいとは限らず、以前に与えられた情報と矛盾する情報やx，yが正しい番号でないような情報が与えられる可能性がある。K個の情報のうち、そのような情報の個数を出力せよ。ただし、以前の情報と矛盾する情報は捨てることとする。

### 制限
* $1\le N \le 50000$
* $0 \le K \le 100000$

### 入力
N,Kと各情報は次のように与えられる。
```
100 7
1 101 1
2 1 2 
2 2 3
2 3 3
1 1 3
2 3 1
1 5 5
```

### 出力
入力例に対する正解は3である。1つ目、4つ目、5つ目がおかしい情報。

